{% extends "sidebar.xml" %}
{% block start %}
<!-- [('owner', '{{query.owner.0}}'),('name', '{{query.name.0}}')] -->
<Storekeeper method="gather" alignment-content="horizontal" repository='repository' filter="project(eq: {'owner':'{{query.owner.0}}','name':'{{query.name.0}}'})" >
{% endblock %}
{% block fine %}
</Storekeeper>
{% endblock %}
{% block breadcrumb %}
<Action route="application/view/page/inventory/overview.xml" ><Graph icon="bi-speedometer2"/></Action>
<Action route="application/view/page/inventory/repositories.xml" ><Graph icon="bi-bookmarks-fill"/><Text>Repositories</Text></Action>
<Action><Graph icon="bi-bookmark-fill"/><Text storekeeper="result.0.name"/></Action>
{% endblock %}
{% block title %}Repository <Text storekeeper="result.0.name"/>{% endblock %}
{% block subtitle %}repository #{{query.name.0}}<Text storekeeper="result.0.description"/>{% endblock %}
{% block bar %}
<SideBar from="inventory" select="application/view/page/inventory/repositories.xml"/>
{% endblock %}
{% block action %}
<Window id="window-delete" type="modal" position="centered" size="xl" title="Delete" action="delete">
    <View url="application/view/content/wizard/repository.xml" data="result.0" />
</Window>
<Window id="window-update" type="modal" position="centered" size="xl" title="Delete" action="update">
    <View url="application/view/content/wizard/repository.xml" data="result.0" />
</Window>
<Group type="button">
    <Action type="button" route="modal:window-update" class="d-inline-flex btn-outline-warning" space="2"><Graph icon="bi-pencil-fill"/><Text class="text-uppercase">Update</Text></Action>
    <Action type="button" route="modal:window-delete" class="d-inline-flex btn-outline-danger" space="2"><Graph icon="bi-trash3"/><Text class="text-uppercase">Delete</Text></Action>
</Group> 
{% endblock %}
{% block content %}
<Container class="card-group" padding="p-4">
    <Container class="card">
        <Container class="card-header">
            <Text>Generali</Text>
        </Container>  
        <Group type="list" class="list-group-flush" expand="vertical">
            <Column alignment-content="between"><Text type="text">ID:</Text><Text storekeeper="result.0.id"/></Column>
            <Column alignment-content="between"><Text type="text">Name:</Text><Text storekeeper="result.0.name"/></Column>
            <Column alignment-content="between"><Text type="text">Description:</Text><Text storekeeper="result.0.description"/></Column>
            <Column alignment-content="between"><Text type="text">Platform:</Text><Text storekeeper="result.0.driver"/></Column>
            <Column alignment-content="between"><Text type="text">Language:</Text><Text storekeeper="result.0.language"/></Column>
            <Column alignment-content="between"><Text type="text">Tags:</Text><Text storekeeper="result.0.tags"/></Column>
            <Column alignment-content="between"><Text type="text">Owner:</Text><Text storekeeper="result.0.ownerr"/></Column>
            <Column alignment-content="between"><Text type="text">Visibility:</Text><Text storekeeper="result.0.private"/></Column>
        </Group>
        <Container class="card-footer">
            <Column alignment-content="between">
                <Text type="text">Created:</Text><Text type="data" storekeeper="result.0.created_at"/>
                <Text type="text">Updated:</Text><Text type="data" storekeeper="result.0.updated_at"/>
            </Column>
        </Container>   
    </Container>

    <Container class="card">
        <Container class="card-header">
            <Text>Repository Info</Text>
        </Container>
        <Group type="list" class="list-group-flush" expand="vertical">
            <Text>Main Branch: main</Text>
            <Text>Commits: 124</Text>
            <Text>Releases: 5</Text>
            <Text>Stars: 12 | Forks: 3</Text>
            <Text>CI Status: ✅ Passing</Text>
            <Text>Coverage: 89%</Text>
        </Group>
        <Container class="card-footer">
            <Text>Last Commit: 2025-04-10T12:47</Text>
        </Container>
    </Container>

    <Container class="card">
        <Container class="card-header">
            <Text>Collaborazione</Text>
        </Container>
        <Group type="list" class="list-group-flush" expand="vertical">
            <Text>Maintainers: alice, marco</Text>
            <Text>Collaboratori: 5</Text>
            <Text>Access: read/write</Text>
            <Text>Merge Policy: 1 approval required</Text>
        </Group>
        <Container class="card-footer">
            <Text>Branch Protection: Active</Text>
        </Container>
    </Container>

    <Container class="card">
        <Container class="card-header">
            <Text>Sicurezza CI/CD</Text>
        </Container>
        <Group type="list" class="list-group-flush" expand="vertical">
            <Text>Secrets: GIT_TOKEN, API_KEY</Text>
            <Text>Vulnerabilities: 0</Text>
            <Text>Pipeline: GitHub Actions</Text>
            <Text>Deploy: auto-prod.yml</Text>
        </Group>
        <Container class="card-footer">
            <Text>Audit: Last scan 2025-04-09</Text>
        </Container>
    </Container>
</Container>

<Group type="nav" margin="m-0" padding="p-0" class="border-bottom">
    <Action class="d-inline-flex" route="tab:overview" space="2"><Graph icon="bi-code"/><Text class="text-uppercase">Code</Text></Action>
    <Action class="d-inline-flex" route="tab:issues" space="2"><Graph icon="bi-exclamation-circle"/><Text class="text-uppercase">Issues</Text></Action>
    <Action class="d-inline-flex" route="tab:pulls" space="2"><Graph icon="bi-git"/><Text class="text-uppercase">Pull Requests</Text></Action>
    <Action class="d-inline-flex" route="tab:actions" space="2"><Graph icon="bi-play-circle"/><Text class="text-uppercase">Actions</Text></Action>
    <Action class="d-inline-flex" route="tab:project" space="2"><Graph icon="bi-kanban"/><Text class="text-uppercase">Project</Text></Action>
    <Action class="d-inline-flex" route="tab:wiki" space="2"><Graph icon="bi-book"/><Text class="text-uppercase">Wiki</Text></Action>
    <Action class="d-inline-flex" route="tab:security" space="2"><Graph icon="bi-shield-exclamation"/><Text class="text-uppercase">Security</Text></Action>
    <Action class="d-inline-flex" route="tab:settings" space="2"><Graph icon="bi-gear"/><Text class="text-uppercase">Settings</Text></Action>
    <Action class="d-inline-flex" route="tab:logs" space="2"><Graph icon="bi-clock-history"/><Text class="text-uppercase">Activity</Text></Action>
</Group>

<Group type="tab" background="#fafafa" padding="p-0" class=" border-bottom" >
    <Container expand="dynamic" id="overview"><Text>Codice sorgente...</Text></Container>
    <Container expand="dynamic" id="issues"><Text>Lista Issues</Text></Container>
    <Container expand="dynamic" id="pulls"><Text>Lista Pull Requests</Text></Container>
    <Container expand="dynamic" id="actions"><Text>Lista Pull Requests</Text></Container>
    <Container expand="dynamic" id="project">
        <Storekeeper method="gather" repository='notes' filter="project(eq: {'location':'{{query.owner.0}}/{{query.name.0}}'})" >
            <Scrum location="{{query.owner.0}}/{{query.name.0}}" />
        </Storekeeper>
    </Container>
    <Container expand="dynamic" id="security"><Text>Security</Text></Container>
    <Container expand="dynamic" id="wiki"><Text>Security</Text></Container>
    <Container expand="dynamic" id="settings"><Text>Configurazioni repo</Text></Container>
    <Container expand="dynamic" id="logs"><Text>Storico attività</Text></Container>
</Group>
{% endblock %}